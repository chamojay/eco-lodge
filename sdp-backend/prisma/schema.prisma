generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model feedback {
  FeedbackID Int       @id @default(autoincrement())
  UserID     Int?
  Message    String    @db.Text
  Rating     Int?
  CreatedAt  DateTime? @default(now()) @db.Timestamp(0)
  users      users?    @relation(fields: [UserID], references: [UserID], onDelete: Cascade, onUpdate: NoAction, map: "feedback_ibfk_1")

  @@index([UserID], map: "UserID")
}

model orderitems {
  OrderItemID    Int             @id @default(autoincrement())
  OrderID        Int?
  ItemID         Int?
  Quantity       Int
  Subtotal       Decimal         @db.Decimal(10, 2)
  orders         orders?         @relation(fields: [OrderID], references: [OrderID], onDelete: Cascade, onUpdate: NoAction, map: "orderitems_ibfk_1")
  restaurantmenu restaurantmenu? @relation(fields: [ItemID], references: [ItemID], onDelete: Cascade, onUpdate: NoAction, map: "orderitems_ibfk_2")

  @@index([ItemID], map: "ItemID")
  @@index([OrderID], map: "OrderID")
}

model orders {
  OrderID     Int            @id @default(autoincrement())
  CustomerID  Int?
  TotalAmount Decimal        @db.Decimal(10, 2)
  OrderDate   DateTime?      @default(now()) @db.Timestamp(0)
  Status      orders_Status? @default(Pending)
  orderitems  orderitems[]
  users       users?         @relation(fields: [CustomerID], references: [UserID], onUpdate: NoAction, map: "orders_ibfk_1")
  payments    payments[]

  @@index([CustomerID], map: "CustomerID")
}

model payments {
  PaymentID     Int                    @id @default(autoincrement())
  UserID        Int?
  ReservationID Int?
  OrderID       Int?
  Amount        Decimal                @db.Decimal(10, 2)
  PaymentMethod payments_PaymentMethod
  PaymentDate   DateTime?              @default(now()) @db.Timestamp(0)
  users         users?                 @relation(fields: [UserID], references: [UserID], onUpdate: NoAction, map: "payments_ibfk_1")
  reservations  reservations?          @relation(fields: [ReservationID], references: [ReservationID], onUpdate: NoAction, map: "payments_ibfk_2")
  orders        orders?                @relation(fields: [OrderID], references: [OrderID], onUpdate: NoAction, map: "payments_ibfk_3")

  @@index([OrderID], map: "OrderID")
  @@index([ReservationID], map: "ReservationID")
  @@index([UserID], map: "UserID")
}

model reservations {
  ReservationID Int                  @id @default(autoincrement())
  CustomerID    Int?
  RoomID        Int?
  CheckInDate   DateTime             @db.Date
  CheckOutDate  DateTime             @db.Date
  TotalAmount   Decimal?             @db.Decimal(10, 2)
  Status        reservations_Status? @default(Pending)
  payments      payments[]
  users         users?               @relation(fields: [CustomerID], references: [UserID], onDelete: Cascade, onUpdate: NoAction, map: "reservations_ibfk_1")
  rooms         rooms?               @relation(fields: [RoomID], references: [RoomID], onDelete: Cascade, onUpdate: NoAction, map: "reservations_ibfk_2")

  @@index([CustomerID], map: "CustomerID")
  @@index([RoomID], map: "RoomID")
}

model restaurantmenu {
  ItemID      Int                     @id @default(autoincrement())
  ItemName    String                  @db.VarChar(100)
  Description String?                 @db.Text
  Price       Decimal                 @db.Decimal(10, 2)
  Category    restaurantmenu_Category
  orderitems  orderitems[]
}

model rooms {
  RoomID       Int            @id @default(autoincrement())
  RoomNumber   String         @unique(map: "RoomNumber") @db.VarChar(10)
  Type         rooms_Type
  Price        Decimal        @db.Decimal(10, 2)
  Status       rooms_Status?  @default(Available)
  reservations reservations[]
}

model users {
  UserID       Int            @id @default(autoincrement())
  FullName     String         @db.VarChar(100)
  Email        String         @unique(map: "Email") @db.VarChar(100)
  PasswordHash String         @db.VarChar(255)
  Role         users_Role
  CreatedAt    DateTime?      @default(now()) @db.Timestamp(0)
  feedback     feedback[]
  orders       orders[]
  payments     payments[]
  reservations reservations[]
}

enum rooms_Type {
  Single
  Double
  Suite
  Deluxe
}

enum rooms_Status {
  Available
  Booked
  Maintenance
}

enum restaurantmenu_Category {
  Starter
  Main_Course @map("Main Course")
  Dessert
  Beverage
}

enum orders_Status {
  Pending
  Processing
  Completed
  Cancelled
}

enum users_Role {
  Admin
  Receptionist
  Cashier
  Customer
}

enum payments_PaymentMethod {
  Cash
  Credit_Card    @map("Credit Card")
  Debit_Card     @map("Debit Card")
  Online_Payment @map("Online Payment")
}

enum reservations_Status {
  Pending
  Confirmed
  Cancelled
  Completed
}
